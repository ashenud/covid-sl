$(document).ready(function(){var e,t,s=!0,a={districtData:"/data/district/patients-data.csv",playbackLimit:10,MapBocToken:"pk.eyJ1IjoiYXNoZW51ZCIsImEiOiJjazlsZG83ZDQwM2g0M2dxdTJ5OTQ4OHh1In0.j_bRFfw78u98EwF_pTaNWw"};if(mapboxgl.supported())Papa.parse(a.districtData,{download:!0,complete:function(s){var r,i,n,c,p=s.data;p.shift(),i=p,n=[],$.each(i,function(e,t){var s={type:"Feature",properties:{camera:{center:[],bearing:-8.9,zoom:11.68}},geometry:{type:"Point",coordinates:[]}};null!=t[0]&&null!=t[1]&&null!=t[2]&&null!=t[3]&&(s.properties.DistrictEn=t[0],s.properties.DistrictSin=t[1],s.properties.Cases=parseInt(t[2]),s.properties.index=e-1,s.properties.Recovered=parseInt(t[3]),s.properties.Deaths=parseInt(t[4]),s.properties.camera.center.push(t[5]),s.properties.camera.center.push(t[6]),s.geometry.coordinates.push(t[5]),s.geometry.coordinates.push(t[6]),s.properties.type=t[7],n.push(s))}),r=n,(e={type:"geojson",data:{type:"FeatureCollection"}}).data.features=r,mapboxgl.accessToken=a.MapBocToken,(t=new mapboxgl.Map({container:"map",style:"mapbox://styles/ashenud/ck9n0r7ws2ih31ipd3q8dtjln",center:[80.6715,7.9],zoom:6.7,maxBounds:[[78.577325,5.771346],[83.106849,10.004859]]})).on("load",function(){t.addSource("patients",e),t.addLayer({id:"district-outer",type:"circle",source:"patients",paint:{"circle-color":["match",["get","type"],"dist","rgba(252, 197, 197,0.8)","qc","rgba(255, 236, 197,0.8)","uns","rgba(197, 255, 249,0.8)","rgba(179, 214, 227,0.8)"],"circle-radius":17}}),t.addLayer({id:"district",type:"circle",source:"patients",paint:{"circle-color":["match",["get","type"],"dist","#ff4040","qc","#ff6969","uns","#ff6969","#33b5e5"],"circle-radius":14}}),t.addLayer({id:"district-count",type:"symbol",source:"patients",layout:{"text-field":["get","Cases"],"text-font":["DIN Offc Pro Medium","Arial Unicode MS Bold"],"text-size":12}});var s=new mapboxgl.Popup({closeButton:!1,closeOnClick:!1});t.on("mouseenter","district",function(e){t.getCanvas().style.cursor="pointer";var a,o=e.features[0].geometry.coordinates.slice();for(a="si"==lang?'<p class="map-font-si">'+e.features[0].properties.DistrictSin+"</p>":'<p class="map-font-en">'+e.features[0].properties.DistrictEn+"</p>";Math.abs(e.lngLat.lng-o[0])>180;)o[0]+=e.lngLat.lng>o[0]?360:-360;s.setLngLat(o).setHTML(a).addTo(t)}),t.on("mouseleave","places",function(){t.getCanvas().style.cursor="",s.remove()}),o(0,e,t)}),c=p,$.each(c,function(e,t){var s;s="si"==lang?"<tr><td class='normal-sinhala fontsize3-si'>"+t[1]+"</td><td class='normal-sinhala fontsize3-si'>"+t[2]+"</td></tr>":"<tr><td>"+t[0]+"</td><td>"+t[2]+"</td></tr>",$("#district-table").find("table").find("tbody").append(s)})}});else{$("#map-wrapper").html("<div class='error-state-ui-outer'><div class='error-state-ui'><img class='error-image' src='./assets/img/browser_not_supported.jpg' /><h2 class='error-title'>Browser Not Supported!</h2><p class='error-description'>Your browser does not support features required for this application.Please update your browser for better experience.</p></div></div>")}function o(e,t,i){if(s){$("#animated-mapoverlaycontainer").fadeIn();var n=t.data.features;i.flyTo(n[e].properties.camera),"si"==lang?$("#location-title").find("span").text(n[e].properties.DistrictSin):$("#location-title").find("span").text(n[e].properties.DistrictEn),$("#location-description").find("span").text(n[e].properties.Cases),i.once("moveend",function(){window.setTimeout(function(){e=e+1===a.playbackLimit?0:e+1,s?o(e,t,i):r()},3e3)})}else r()}function r(){$("#animated-mapoverlaycontainer").fadeOut(),t.flyTo({center:[80.6715,7.9],zoom:6.7,pitch:0,bearing:0})}$("#map-switcher").change(function(){s=!$(this).prop("checked"),o(0,e,t)}),$("#district-tableshowmore").click(function(e){e.preventDefault(),$(this).hasClass("showmore")?($("#district-table").addClass("show-content"),$(this).removeClass("showmore"),$(this).addClass("showless"),$(this).html("<span>"+$(this).data("lesstext")+'</span><i class= "now-ui-icons arrows-1_minimal-up" ></i >')):($("#district-table").removeClass("show-content"),$(this).addClass("showmore"),$(this).removeClass("showless"),$(this).html("<span>"+$(this).data("moretext")+'</span><i class= "now-ui-icons arrows-1_minimal-down" ></i >'),$([document.documentElement,document.body]).animate({scrollTop:$("#district-table").offset().top-100},500))})});